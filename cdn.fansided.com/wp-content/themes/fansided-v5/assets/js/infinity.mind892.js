jQuery(function(t){t(document).ready(function(){function i(){S=window.scrollY,a()}function a(){T||requestAnimationFrame(e),T=!0}function e(){var i=t("article"),a=t(".infinity-indicator"),e=t("span.do-analytics"),o=t(document).find(".do-urlswap");"undefined"==typeof window.fsUseType&&(window.fsUseType="immediate",window.fsExpire=0);var d=0;t(i).each(function(i){if(t(this).visible(!0)&&t(this).attr("data-prev")&&1!=D&&!t(this).attr("data-fetched")){D=!0;var e=t(this).attr("data-prev");"undefined"!=typeof e&&m(e)&&(a.show().html('<span class="in-progress"></span>'),t(this).attr("data-fetched",""),r("prefetch",d,e,n,720),window.fsUseType="fetched",window.fsExpire=720)}if(t(this).visible(!0)&&t(this).attr("data-prev")&&t(this).children(".article-footer").visible(!0)){D=!0;var e=t(this).attr("data-prev");t(this).removeAttr("data-prev"),r(window.fsUseType,d,e,n,window.fsExpire)}d++}),t(e).visible(!0)&&(c(),l(),u()),t(o).each(function(i){if(t(this).visible(!0)){var a=t(this).next().find("h1").html(),e=t(this).attr("data-url"),n=t(this).attr("data-sent");"true"==n?f("nohistory",a,e):(t(this).attr("data-sent","true"),f("history",a,e))}}),T=!1}function n(i){var a=t(".infinity"),e=t(".infinity-indicator");if(p(),a.remove(),"post"==i.type){var n=o(i);d(n,i.output),e.hide().removeClass("infinity-indicator").addClass("indicated"),"undefined"!=typeof STR&&null!==STR&&STR.Tag.boot()}else"card"==i.type&&(s(i.output),e.hide().removeClass("infinity-indicator").addClass("indicated"),lazyLoadInit());D=!1}function r(t,i,a,e,n){v()?"prefetch"===t?b.getItem(a).then(function(r){null!==r?y(t,i,r,a,e,n):w(t,i,a,e,n)}):b.getItem(a).then(function(r){null===r?w(t,i,a,e):r.timestub?y(t,i,r,a,e,n):w(t,i,a,e,n)}):"prefetch"!=t&&w(t,i,a,e,n)}function o(t){var i=t;return window.fsInfiniteScrollDataLayer=i.dataLayer,"Flat Rate Pageviews"==i.payEvent&&(i.postTitle=i.postTitle+"__"+i.postID),'<span class="do-analytics" data-no-track="'+i.noTrack+'" data-id="'+i.id+'" data-guid="'+i.guid+'" data-perma="'+i.perma+'" data-username="'+i.username+'" data-payevt="'+i.payevt+'" data-primary-topic="'+i.primaryTopic+'" data-wc-range-int="'+i.wcRangeInt+'" data-topic-string="'+i.topicString+'" data-fs-api-key="'+i.fsApiKey+'" data-title="'+i.title+'" data-cat="'+i.cat+'" data-post-type="'+i.postType+'"></span>'}function d(t,i){g.append(t+i),D=!1}function s(t){g.append(t),D=!1}function c(){var i=t(".do-analytics");infinityData.siteUID,infinityData.siteName,i.attr("data-no-track"),i.attr("data-id"),i.attr("data-perma"),i.attr("data-guid"),i.attr("data-username"),i.attr("data-payevt"),i.attr("data-primary-topic"),i.attr("data-post-type"),i.attr("data-wc-range-int"),i.attr("data-topic-string"),i.attr("data-fs-api-key"),i.attr("data-title"),i.attr("data-cat"),infinityData.siteDivision;window.fsInfiniteScrollDataLayer&&(window.dataLayer=window.dataLayer||[],window.dataLayer.push(window.fsInfiniteScrollDataLayer),window.dataLayer.push({isInfiniteScrollArticle:!0}),window.dataLayer.push({event:"pageview"}),window.dataLayer.push({event:"newInfiniteScrollArticle"}));var a=document.createEvent("Event");a.initEvent("onInfiniteScroll",!0,!0),document.dispatchEvent(a)}function f(t,i,a){if(window.location.origin+window.location.pathname!==a){var e=window.location.href;"history"===t&&a!=e?window.history.pushState(null,i,a):a!=e&&window.history.replaceState(null,i,a)}}function l(){googletag.pubads().refresh(["bottom"],{changeCorrelator:!1})}function p(){var i=t("article .fs_ad_widget-ad");t.each(i,function(i){var a=t(this).closest("article");if(a.length){var e=a.attr("id").replace(/post-/,""),n=t(this).find("div:first");"undefined"!=typeof n.attr("id")&&n.attr("id")!==!1&&n.length&&0>n.attr("id").indexOf(e)&&n.attr("id",n.attr("id")+"_"+e)}})}function u(){var i=t("span.do-analytics");i.attr("data-title");i.removeClass("do-analytics").addClass("sent-analytics")}function w(i,a,e,n,r){"prefetch"!==i&&t.get({url:infinityData.resturl+e+"/?device="+infinityData.device+"&count="+a+"&initialPost="+L+"&initialTerm="+E+"&sponsoredTerms="+x,beforeSend:function(t){t.setRequestHeader("X-API-Nonce",infinityData.nonce)}}).done(function(t){if("object"!=typeof t)try{t=JSON.parse(t)}catch(a){}t.timestub=new Date,"prefetch"!=i&&(n(t),h()),r>0&&v()&&b.setItem(e,t).then(function(t){})["catch"](function(t){})})}function y(t,i,a,e,n,r){var o=new Date(a.timestub),d=new Date,s=o;if(s.setMinutes(s.getMinutes()+r),d.getTime()>s.getTime()){var c=o;c.setHours(o.getHours()+24),d.getTime()>c.getTime()?b.clear().then(function(){w(t,i,e,n,r)})["catch"](function(t){}):(b.removeItem(e),w(t,i,e,n,r))}else"prefetch"!=t&&(n(a),h())}function h(){"object"==typeof bcJumpstart&&bcJumpstart.init.core()}function v(){return!1}function m(t){var i=[" ","\n","\r","\t","\f","\x0B"," "," "," "," "," "," "," "," "," "," "," "," ","​","\u2028","\u2029","　"].join("");return("number"==typeof t||"string"==typeof t&&i.indexOf(t.slice(-1))===-1)&&""!==t&&!isNaN(t)}window.loading=!1;var g=t("#main"),D=window.loading,I=t(".infinity-indicator"),S=0,T=!1,b=localforage.createInstance({name:infinityData.siteName+"-posts",driver:[localforage.INDEXEDDB,localforage.WEBSQL],version:1});if(I.hide(),window.infiniteScrollInitialData)var L=window.infiniteScrollInitialData.postId,E=window.infiniteScrollInitialData.termId,x=window.infiniteScrollInitialData.sponsoredTerms?window.infiniteScrollInitialData.sponsoredTerms.toString():"";window.addEventListener("scroll",i,!1)})});