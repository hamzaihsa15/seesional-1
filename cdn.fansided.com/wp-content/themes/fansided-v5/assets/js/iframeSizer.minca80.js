!function(e){"use strict";function n(n,t,i){"addEventListener"in e?n.addEventListener(t,i,!1):"attachEvent"in e&&n.attachEvent("on"+t,i)}function t(n,t,i){"removeEventListener"in e?n.removeEventListener(t,i,!1):"detachEvent"in e&&n.detachEvent("on"+t,i)}function i(){var n,t=["moz","webkit","o","ms"];for(n=0;n<t.length&&!A;n+=1)A=e[t[n]+"RequestAnimationFrame"];A||r("setup","RequestAnimationFrame not supported")}function o(e){return j[e]?j[e].log:O}function r(e,n){u("log",e,n,o(e))}function a(e,n){u("info",e,n,o(e))}function c(e,n){u("warn",e,n,!0)}function u(n,t,i,o){!0===o&&"object"==typeof e.console}function f(i){function o(){function e(){b(X),m(Y)}f("Height"),f("Width"),p(e,X,"init")}function u(){var e=Q.substr(S).split(":");return{iframe:j[e[0]].iframe,id:e[0],height:e[1],width:e[2],type:e[3]}}function f(e){var n=Number(j[Y]["max"+e]),t=Number(j[Y]["min"+e]),i=e.toLowerCase(),o=Number(X[i]);r(Y,"Checking "+i+" is in range "+t+"-"+n),o<t&&(o=t,r(Y,"Set "+i+" to min value")),o>n&&(o=n,r(Y,"Set "+i+" to max value")),X[i]=""+o}function w(){function e(){function e(){var e=0,i=!1;for(r(Y,"Checking connection is from allowed list of origins: "+t);e<t.length;e++)if(t[e]===n){i=!0;break}return i}function i(){var e=j[Y].remoteHost;return r(Y,"Checking connection is from: "+e),n===e}return t.constructor===Array?e():i()}var n=i.origin,t=j[Y].checkOrigin;if(t&&""+n!="null"&&!e())throw new Error("Unexpected message received from: "+n+" for "+X.iframe.id+". Message was: "+i.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}function x(){return W===(""+Q).substr(0,S)&&Q.substr(S).split(":")[0]in j}function M(){var e=X.type in{"true":1,"false":1,undefined:1};return e&&r(Y,"Ignoring init message from meta parent page"),e}function F(e){return Q.substr(Q.indexOf(":")+P+e)}function z(e){r(Y,"MessageCallback passed: {iframe: "+X.iframe.id+", message: "+e+"}"),q("messageCallback",{iframe:X.iframe,message:JSON.parse(e)}),r(Y,"--")}function I(){var n=document.body.getBoundingClientRect(),t=X.iframe.getBoundingClientRect();return JSON.stringify({iframeHeight:t.height,iframeWidth:t.width,clientHeight:Math.max(document.documentElement.clientHeight,e.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,e.innerWidth||0),offsetTop:parseInt(t.top-n.top,10),offsetLeft:parseInt(t.left-n.left,10),scrollTop:e.pageYOffset,scrollLeft:e.pageXOffset})}function E(e,n){function t(){y("Send Page Info","pageInfo:"+I(),e,n)}k(t,32)}function R(){function i(n,t){function i(){j[c]?E(j[c].iframe,c):o()}["scroll","resize"].forEach(function(o){r(c,n+o+" listener for sendPageInfo"),t(e,o,i)})}function o(){i("Remove ",t)}function a(){i("Add ",n)}var c=Y;a(),j[c].stopPageInfo=o}function C(){j[Y]&&j[Y].stopPageInfo&&(j[Y].stopPageInfo(),delete j[Y].stopPageInfo)}function O(){var e=!0;return null===X.iframe&&(c(Y,"IFrame ("+X.id+") not found"),e=!1),e}function T(e){var n=e.getBoundingClientRect();return d(Y),{x:Math.floor(Number(n.left)+Number(H.x)),y:Math.floor(Number(n.top)+Number(H.y))}}function N(n){function t(){H=u,A(),r(Y,"--")}function i(){return{x:Number(X.width)+a.x,y:Number(X.height)+a.y}}function o(){e.parentIFrame?e.parentIFrame["scrollTo"+(n?"Offset":"")](u.x,u.y):c(Y,"Unable to scroll to requested position, window.parentIFrame not found")}var a=n?T(X.iframe):{x:0,y:0},u=i();r(Y,"Reposition requested from iFrame (offset x:"+a.x+" y:"+a.y+")"),e.top!==e.self?o():t()}function A(){!1!==q("scrollCallback",H)?m(Y):g()}function L(n){function t(){var e=T(c);r(Y,"Moving to in page link (#"+o+") at x: "+e.x+" y: "+e.y),H={x:e.x,y:e.y},A(),r(Y,"--")}function i(){e.parentIFrame?e.parentIFrame.moveToAnchor(o):r(Y,"In page link #"+o+" not found and window.parentIFrame not found")}var o=n.split("#")[1]||"",a=decodeURIComponent(o),c=document.getElementById(a)||document.getElementsByName(a)[0];c?t():e.top!==e.self?i():r(Y,"In page link #"+o+" not found")}function q(e,n){return s(Y,e,n)}function V(){switch(j[Y].firstRun&&J(),X.type){case"close":l(X.iframe);break;case"message":z(F(6));break;case"scrollTo":N(!1);break;case"scrollToOffset":N(!0);break;case"pageInfo":E(j[Y].iframe,Y),R();break;case"pageInfoStop":C();break;case"inPageLink":L(F(9));break;case"reset":h(X);break;case"init":o(),q("initCallback",X.iframe),q("resizedCallback",X);break;default:o(),q("resizedCallback",X)}}function U(e){var n=!0;return j[e]||(n=!1,c(X.type+" No settings for "+e+". Message was: "+Q)),n}function D(){for(var e in j)y("iFrame requested init",v(e),document.getElementById(e),e)}function J(){j[Y].firstRun=!1}var Q=i.data,X={},Y=null;"[iFrameResizerChild]Ready"===Q?D():x()?(X=u(),Y=B=X.id,!M()&&U(Y)&&(r(Y,"Received: "+Q),O()&&w()&&V())):a(Y,"Ignored: "+Q)}function s(e,n,t){var i=null,o=null;if(j[e]){if(i=j[e][n],"function"!=typeof i)throw new TypeError(n+" on iFrame["+e+"] is not a function");o=i(t)}return o}function l(e){var n=e.id;r(n,"Removing iFrame: "+n),e.parentNode&&e.parentNode.removeChild(e),s(n,"closedCallback",n),r(n,"--"),delete j[n]}function d(n){null===H&&(H={x:void 0!==e.pageXOffset?e.pageXOffset:document.documentElement.scrollLeft,y:void 0!==e.pageYOffset?e.pageYOffset:document.documentElement.scrollTop},r(n,"Get page position: "+H.x+","+H.y))}function m(n){null!==H&&(e.scrollTo(H.x,H.y),r(n,"Set page position: "+H.x+","+H.y),g())}function g(){H=null}function h(e){function n(){b(e),y("reset","reset",e.iframe,e.id)}r(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame")),d(e.id),p(n,e,"reset")}function b(e){function n(n){e.iframe.style[n]=e[n]+"px",r(e.id,"IFrame ("+o+") "+n+" set to "+e[n]+"px")}function t(n){T||"0"!==e[n]||(T=!0,r(o,"Hidden iFrame detected, creating visibility listener"),x())}function i(e){n(e),t(e)}var o=e.iframe.id;j[o]&&(j[o].sizeHeight&&i("height"),j[o].sizeWidth&&i("width"))}function p(e,n,t){t!==n.type&&A?(r(n.id,"Requesting animation frame"),A(e)):e()}function y(e,n,t,i){function o(){var o=j[i].targetOrigin;r(i,"["+e+"] Sending msg to iframe["+i+"] ("+n+") targetOrigin: "+o),t.contentWindow.postMessage(W+n,o)}function a(){c(i,"["+e+"] IFrame("+i+") not found")}function u(){t&&"contentWindow"in t&&null!==t.contentWindow?o():a()}i=i||t.id,j[i]&&u()}function v(e){return e+":"+j[e].bodyMarginV1+":"+j[e].sizeWidth+":"+j[e].log+":"+j[e].interval+":"+j[e].enablePublicMethods+":"+j[e].autoResize+":"+j[e].bodyMargin+":"+j[e].heightCalculationMethod+":"+j[e].bodyBackground+":"+j[e].bodyPadding+":"+j[e].tolerance+":"+j[e].inPageLinks+":"+j[e].resizeFrom+":"+j[e].widthCalculationMethod}function w(e,t){function i(){function n(n){1/0!==j[x][n]&&0!==j[x][n]&&(e.style[n]=j[x][n]+"px",r(x,"Set "+n+" = "+j[x][n]+"px"))}function t(e){if(j[x]["min"+e]>j[x]["max"+e])throw new Error("Value for min"+e+" can not be greater than max"+e)}t("Height"),t("Width"),n("maxHeight"),n("minHeight"),n("maxWidth"),n("minWidth")}function o(){var e=t&&t.id||V.id+C++;return null!==document.getElementById(e)&&(e+=C++),e}function a(n){return B=n,""===n&&(e.id=n=o(),O=(t||{}).log,B=n,r(n,"Added missing iframe ID: "+n+" ("+e.src+")")),n}function u(){switch(r(x,"IFrame scrolling "+(j[x].scrolling?"enabled":"disabled")+" for "+x),e.style.overflow=!1===j[x].scrolling?"hidden":"auto",j[x].scrolling){case!0:e.scrolling="yes";break;case!1:e.scrolling="no";break;default:e.scrolling=j[x].scrolling}}function f(){"number"!=typeof j[x].bodyMargin&&"0"!==j[x].bodyMargin||(j[x].bodyMarginV1=j[x].bodyMargin,j[x].bodyMargin=""+j[x].bodyMargin+"px")}function s(){var n=j[x].firstRun,t=j[x].heightCalculationMethod in L;!n&&t&&h({iframe:e,height:0,width:0,type:"init"})}function d(){Function.prototype.bind&&(j[x].iframe.iFrameResizer={close:l.bind(null,j[x].iframe),resize:y.bind(null,"Window resize","resize",j[x].iframe),moveToAnchor:function(e){y("Move to anchor","moveToAnchor:"+e,j[x].iframe,x)},sendMessage:function(e){e=JSON.stringify(e),y("Send Message","message:"+e,j[x].iframe,x)}})}function m(t){function i(){y("iFrame.onload",t,e),s()}n(e,"load",i),y("init",t,e)}function g(e){if("object"!=typeof e)throw new TypeError("Options is not an object")}function b(e){for(var n in V)V.hasOwnProperty(n)&&(j[x][n]=e.hasOwnProperty(n)?e[n]:V[n])}function p(e){return""===e||"file://"===e?"*":e}function w(n){n=n||{},j[x]={firstRun:!0,iframe:e,remoteHost:e.src.split("/").slice(0,3).join("/")},g(n),b(n),j[x].targetOrigin=!0===j[x].checkOrigin?p(j[x].remoteHost):"*"}function k(){return x in j&&"iFrameResizer"in e}var x=a(e.id);k()?c(x,"Ignored iFrame, already setup."):(w(t),u(),i(),f(),m(v(x)),d())}function k(e,n){null===q&&(q=setTimeout(function(){q=null,e()},n))}function x(){function n(){function e(e){function n(n){return"0px"===j[e].iframe.style[n]}function t(e){return null!==e.offsetParent}t(j[e].iframe)&&(n("height")||n("width"))&&y("Visibility change","resize",j[e].iframe,e)}for(var n in j)e(n)}function t(e){r("window","Mutation observed: "+e[0].target+" "+e[0].type),k(n,16)}function i(){var e=document.querySelector("body"),n={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0},i=new o(t);i.observe(e,n)}var o=e.MutationObserver||e.WebKitMutationObserver;o&&i()}function M(e){function n(){z("Window "+e,"resize")}r("window","Trigger event: "+e),k(n,16)}function F(){function e(){z("Tab Visable","resize")}"hidden"!==document.visibilityState&&(r("document","Trigger event: Visiblity change"),k(e,16))}function z(e,n){function t(e){return"parent"===j[e].resizeFrom&&j[e].autoResize&&!j[e].firstRun}for(var i in j)t(i)&&y(e,n,document.getElementById(i),i)}function I(){n(e,"message",f),n(e,"resize",function(){M("resize")}),n(document,"visibilitychange",F),n(document,"-webkit-visibilitychange",F),n(e,"focusin",function(){M("focus")}),n(e,"focus",function(){M("focus")})}function E(){function e(e,n){function i(){if(!n.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==n.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+n.tagName+">")}n&&(i(),w(n,e),t.push(n))}function n(e){e&&e.enablePublicMethods&&c("enablePublicMethods option has been removed, public methods are now always available in the iFrame")}var t;return i(),I(),function(i,o){switch(t=[],n(i),typeof o){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(o||"iframe"),e.bind(void 0,i));break;case"object":e(i,o);break;default:throw new TypeError("Unexpected data type ("+typeof o+")")}return t}}function R(e){e.fn?e.fn.iFrameResize||(e.fn.iFrameResize=function(e){function n(n,t){w(t,e)}return this.filter("iframe").each(n).end()}):a("","Unable to bind to jQuery, it is not fully loaded.")}var C=0,O=!1,T=!1,N="message",P=N.length,W="[iFrameSizer]",S=W.length,H=null,A=e.requestAnimationFrame,L={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},j={},q=null,B="Host Page",V={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,tolerance:0,widthCalculationMethod:"scroll",closedCallback:function(){},initCallback:function(){},messageCallback:function(){c("MessageCallback function not defined")},resizedCallback:function(){},scrollCallback:function(){return!0}};e.jQuery&&R(jQuery),"function"==typeof define&&define.amd?define([],E):"object"==typeof module&&"object"==typeof module.exports?module.exports=E():e.iFrameResize=e.iFrameResize||E()}(window||{});