!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):jQuery&&!jQuery.fn.hoverIntent&&e(jQuery)}(function(e){"use strict";var t,n,o={interval:100,sensitivity:6,timeout:0},a=0,s=function(e){t=e.pageX,n=e.pageY},r=function(e,o,a,i){return Math.sqrt((a.pX-t)*(a.pX-t)+(a.pY-n)*(a.pY-n))<i.sensitivity?(o.off(a.event,s),delete a.timeoutId,a.isActive=!0,e.pageX=t,e.pageY=n,delete a.pX,delete a.pY,i.over.apply(o[0],[e])):(a.pX=t,a.pY=n,a.timeoutId=setTimeout(function(){r(e,o,a,i)},i.interval),void 0)},i=function(e,t,n,o){return delete t.data("hoverIntent")[n.id],o.apply(t[0],[e])};e.fn.hoverIntent=function(t,n,l){var d=a++,u=e.extend({},o);e.isPlainObject(t)?(u=e.extend(u,t),e.isFunction(u.out)||(u.out=u.over)):u=e.isFunction(n)?e.extend(u,{over:t,out:n,selector:l}):e.extend(u,{over:t,out:t,selector:n});var c=function(t){var n=e.extend({},t),o=e(this),a=o.data("hoverIntent");a||o.data("hoverIntent",a={});var l=a[d];l||(a[d]=l={id:d}),l.timeoutId&&(l.timeoutId=clearTimeout(l.timeoutId));var c=l.event="mousemove.hoverIntent.hoverIntent"+d;if("mouseenter"===t.type){if(l.isActive)return;l.pX=n.pageX,l.pY=n.pageY,o.off(c,s).on(c,s),l.timeoutId=setTimeout(function(){r(n,o,l,u)},u.interval)}else{if(!l.isActive)return;o.off(c,s),l.timeoutId=setTimeout(function(){i(n,o,l,u.out)},u.timeout)}};return this.on({"mouseenter.hoverIntent":c,"mouseleave.hoverIntent":c},u.selector)}}),jQuery(document).ready(function(e){function t(e){e=(e||navigator.userAgent).toLowerCase();var t=e.match(/android\s([0-9\.]*)/);return!!t&&t[1]}function n(){var t=e(".fs-network-menu.desktop").width(),n=e(".fs-network-menu.desktop > li"),o=0;e.each(n,function(n,a){var s=e(a);o+=s.width(),o<=t?s.removeClass("network-item-hide").addClass("network-item-show"):s.removeClass("network-item-show").addClass("network-item-hide")})}function o(e){e.siblings().removeClass("open"),e.addClass("open"),a(e)}function a(t){if(e(t).hasClass("loading")||e(t).hasClass("loaded"))return!1;if(e(t).hasClass("feed-dropdown")){var n=[];e(".primary .column",t).each(function(){var t=e(this).data("feed"),o={feed:t,layout:e(this).data("layout")};n.push(o)});s(n,t);return!1}}function s(t,n){var o=encodeURIComponent(JSON.stringify(t)),a=siteData.resturl+"menus/network-nav/dropdown/?columns="+o;e.ajax({url:a,type:"GET",beforeSend:function(t){t.setRequestHeader("x-fsapi-nonce",siteData.nonce),e(n).addClass("loading"),e(".primary .column").append('<span class="loader" />')},success:function(t){e(".loader").remove(),e(".primary .column",n).each(function(o){e(this).prepend(t[o]),e(n).addClass("loaded"),e(n).removeClass("loading")});var o=e(".trending .column");if(o.length>0){var a=o.find("ul"),s=a.find("li"),r=s.width(),i=s.length,l=10,d=parseInt(s.css("margin-right").replace("px",""))+l,u=(r+d)*i-d;a.width(u)}},error:function(e){console.log(e)}})}function r(){var t=e("body");t.width()<600&&t.on("click",".fs-utility-link",function(t){var n=e(this),o=n.parent(),a=o.data("feed")||"",s=o.data("group")||"",r=o.data("links")||"";"link"!==o.data("type")&&(t.preventDefault(),!1!==o.data("loaded")&&void 0!=o.data("loaded")||o.hasClass("loading")||(o.addClass("loading"),o.find(".fs-utility-api-nav-toggle").addClass("open"),i(o,a,s,r)),!0===o.data("loaded")&&(o.find(".fs-utility-nav-content").stop().slideToggle(500),o.find(".fs-utility-api-nav-toggle").toggleClass("open")))})}function i(t,n,o,a){var s=encodeURIComponent(JSON.stringify(a)),r=encodeURIComponent(JSON.stringify(n)),i=encodeURIComponent(JSON.stringify(o)),l=siteData.resturl+"menus/network-nav/mobile/?subcontent="+r+"&group="+i+"&links="+s;e.ajax({url:l,type:"GET",beforeSend:function(e){e.setRequestHeader("x-fsapi-nonce",siteData.nonce),t.append('<span class="loader" />')},success:function(n){console.log(n),e(".loader").remove(),t.removeClass("loading"),t.append(n),t.data("loaded",!0),t.attr("data-loaded",!0),t.data("toggle","open"),t.attr("data-toggle","open"),e(t).find(".fs-utility-nav-content").fadeIn("fast")},error:function(e){t.append("<p>No data could be loaded</p>")}})}e(".fs-network-util-toggle").click(function(){e("body").toggleClass("fs-util-nav-open"),e(".fs-network-util").toggleClass("is-open"),e(".fs-network-util-toggle").toggleClass("open")}),e(".fs-network-social-toggle").click(function(){e(".fs-network-social").toggleClass("is-open"),e(".fs-network-social-toggle").toggleClass("open")}),e(".fs-network-search-toggle").click(function(){e("#fs-network-search").toggleClass("open"),e("#fs-network-menu").toggleClass("search-visible")});var l=t();if(l=parseInt(l,10),l<5&&(e(".fs-network-search-toggle").remove(),e(".fs-network-util-toggle").remove(),e(".fs-network-util").remove()),n(),e(window).resize(n),r(),e("html").hasClass("touch"))e(".fs-network-menu li.dropdown > a").on("click",function(t){t.preventDefault();var n=e(this).parent();o(n)});else{var d=e(".fs-network-menu li.dropdown > a"),u=e(".loader");d.on("click",function(e){e.preventDefault()});var c=function(){var t=e(this);o(t)},f=function(){e(".fs-network-menu li.dropdown").removeClass("open"),u.length>0&&u.remove()};e(".fs-network-menu").hoverIntent({over:c,out:f,timeout:200,selector:"li.dropdown"})}}),jQuery(window).scroll(function(){jQuery(window).scrollTop()>147?(jQuery("#fs-network-nav").addClass("scrolled"),jQuery("body").addClass("fs-network-nav-scrolled")):(jQuery("#fs-network-nav").removeClass("scrolled"),jQuery("body").removeClass("fs-network-nav-scrolled")),jQuery(window).width()>767&&jQuery("body").hasClass("single-post")&&(jQuery(window).scrollTop()>147?jQuery("#fs-network-nav").addClass("flipcard"):jQuery("#fs-network-nav").removeClass("flipcard"))});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS1ob3ZlcmludGVudC5qcyIsIm5ldHdvcmstbmF2LmpzIl0sIm5hbWVzIjpbImZhY3RvcnkiLCJkZWZpbmUiLCJhbWQiLCJqUXVlcnkiLCJmbiIsImhvdmVySW50ZW50IiwiJCIsImNYIiwiY1kiLCJfY2ZnIiwiaW50ZXJ2YWwiLCJzZW5zaXRpdml0eSIsInRpbWVvdXQiLCJJTlNUQU5DRV9DT1VOVCIsInRyYWNrIiwiZXYiLCJwYWdlWCIsInBhZ2VZIiwiY29tcGFyZSIsIiRlbCIsInMiLCJjZmciLCJNYXRoIiwic3FydCIsInBYIiwicFkiLCJvZmYiLCJldmVudCIsInRpbWVvdXRJZCIsImlzQWN0aXZlIiwib3ZlciIsImFwcGx5Iiwic2V0VGltZW91dCIsImRlbGF5Iiwib3V0IiwiZGF0YSIsImlkIiwiaGFuZGxlckluIiwiaGFuZGxlck91dCIsInNlbGVjdG9yIiwiaW5zdGFuY2VJZCIsImV4dGVuZCIsImlzUGxhaW5PYmplY3QiLCJpc0Z1bmN0aW9uIiwiaGFuZGxlSG92ZXIiLCJlIiwidGhpcyIsImhvdmVySW50ZW50RGF0YSIsInN0YXRlIiwiY2xlYXJUaW1lb3V0IiwibW91c2Vtb3ZlIiwidHlwZSIsIm9uIiwibW91c2VlbnRlci5ob3ZlckludGVudCIsIm1vdXNlbGVhdmUuaG92ZXJJbnRlbnQiLCJkb2N1bWVudCIsInJlYWR5IiwiZ2V0QW5kcm9pZFZlcnNpb24iLCJ1YSIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsInRvTG93ZXJDYXNlIiwibWF0Y2giLCJjaGVja01lbnVEaXNwbGF5U2l6ZSIsImRlc2t0b3BOYXZXaWR0aCIsIndpZHRoIiwiZWxlbWVudHMiLCJ0cmFja2VyIiwiZWFjaCIsImluZGV4IiwidmFsIiwiZWwiLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwidG9nZ2xlU3RhdGUiLCJzaWJsaW5ncyIsImdldERyb3Bkb3duQ29udGVudCIsIm15TEkiLCJoYXNDbGFzcyIsImRhdGFGZWVkcyIsImFyZ3MiLCJhZGRGZWVkIiwiZmVlZCIsImxheW91dCIsInB1c2giLCJnZXRDb2x1bW5Db250ZW50IiwiZmVlZHMiLCJlbmNvZGVVUklDb21wb25lbnQiLCJKU09OIiwic3RyaW5naWZ5IiwidXJsIiwic2l0ZURhdGEiLCJyZXN0dXJsIiwiYWpheCIsImJlZm9yZVNlbmQiLCJ4aHIiLCJzZXRSZXF1ZXN0SGVhZGVyIiwibm9uY2UiLCJhcHBlbmQiLCJzdWNjZXNzIiwicmVzcG9uc2UiLCJyZW1vdmUiLCJwcmVwZW5kIiwidHJlbmRpbmciLCJsZW5ndGgiLCJsaXN0IiwiZmluZCIsImxpc3ROb2RlIiwibGlzdE5vZGVXaWR0aCIsImxpc3ROb2RlQ291bnQiLCJsaXN0QnVmZmVyIiwibGlzdE1hcmdpbiIsInBhcnNlSW50IiwiY3NzIiwicmVwbGFjZSIsImxpc3RXaWR0aCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsImdldE1vYmlsZUNvbnRlbnQiLCJib2R5IiwibGluayIsImxpIiwicGFyZW50IiwiZ3JvdXAiLCJsaW5rcyIsInByZXZlbnREZWZhdWx0IiwidW5kZWZpbmVkIiwibG9hZGVkTW9iaWxlQ29udGVudCIsInN0b3AiLCJzbGlkZVRvZ2dsZSIsInRvZ2dsZUNsYXNzIiwiZmluYWxMaW5rcyIsImZpbmFsRmVlZCIsImZpbmFsR3JvdXAiLCJhdHRyIiwiZmFkZUluIiwiY2xpY2siLCJhbmRyb2lkVmVyc2lvbiIsIndpbmRvdyIsInJlc2l6ZSIsIm1lbnVJdGVtTGluayIsImxvYWRlciIsIm9wZW5Ecm9wZG93biIsImNsb3NlRHJvcGRvd24iLCJzY3JvbGwiLCJzY3JvbGxUb3AiXSwibWFwcGluZ3MiOiJDQWdDQSxTQUFBQSxHQUNBLFlBQ0EsbUJBQUFDLFNBQUFBLE9BQUFDLElBQ0FELFFBQUEsVUFBQUQsR0FDQUcsU0FBQUEsT0FBQUMsR0FBQUMsYUFDQUwsRUFBQUcsU0FFQSxTQUFBRyxHQUNBLFlBR0EsSUFVQUMsR0FBQUMsRUFWQUMsR0FDQUMsU0FBQSxJQUNBQyxZQUFBLEVBQ0FDLFFBQUEsR0FJQUMsRUFBQSxF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QUFBLFFBQUEsU0FBQVAsR0FDQUEsRUFBQWlGLGdCQUNBLElBQUFqRCxHQUFBdkUsRUFBQXdDLE1BQUE2RSxRQUNBakQsR0FBQUcsU0FHQSxDQUVBLEdBQUFnRSxHQUFBdkksRUFBQSxvQ0FDQXdJLEVBQUF4SSxFQUFBLFVBRUF1SSxHQUFBekYsR0FBQSxRQUFBLFNBQUFQLEdBQ0FBLEVBQUFpRixrQkFHQSxJQUFBaUIsR0FBQSxXQUNBLEdBQUFsRSxHQUFBdkUsRUFBQXdDLEtBQ0E0QixHQUFBRyxJQUdBbUUsRUFBQSxXQUNBMUksRUFBQSxnQ0FBQWtFLFlBQUEsUUFHQXNFLEVBQUF0QyxPQUFBLEdBQ0FzQyxFQUFBekMsU0FJQS9GLEdBQUEsb0JBQUFELGFBQ0F5QixLQUFBaUgsRUFDQTdHLElBQUE4RyxFQUNBcEksUUFBQSxJQUNBMkIsU0FBQSxtQkEwTEFwQyxPQUFBd0ksUUFBQU0sT0FBQSxXQUNBOUksT0FBQXdJLFFBQUFPLFlBQUEsS0FDQS9JLE9BQUEsbUJBQUFzRSxTQUFBLFlBQ0F0RSxPQUFBLFFBQUFzRSxTQUFBLDZCQUVBdEUsT0FBQSxtQkFBQXFFLFlBQUEsWUFDQXJFLE9BQUEsUUFBQXFFLFlBQUEsNEJBR0FyRSxPQUFBd0ksUUFBQTFFLFFBQUEsS0FBQTlELE9BQUEsUUFBQTJFLFNBQUEsaUJBQ0EzRSxPQUFBd0ksUUFBQU8sWUFBQSxJQUNBL0ksT0FBQSxtQkFBQXNFLFNBQUEsWUFFQXRFLE9BQUEsbUJBQUFxRSxZQUFBIiwiZmlsZSI6Im5ldHdvcmstbmF2Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogaG92ZXJJbnRlbnQgdjEuOC4xIC8vIDIwMTQuMDguMTEgLy8galF1ZXJ5IHYxLjkuMStcbiAqIGh0dHA6Ly9icmlhbmNoZXJuZS5naXRodWIuaW8vanF1ZXJ5LWhvdmVySW50ZW50L1xuICpcbiAqIFlvdSBtYXkgdXNlIGhvdmVySW50ZW50IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgTUlUIGxpY2Vuc2UuIEJhc2ljYWxseSB0aGF0XG4gKiBtZWFucyB5b3UgYXJlIGZyZWUgdG8gdXNlIGhvdmVySW50ZW50IGFzIGxvbmcgYXMgdGhpcyBoZWFkZXIgaXMgbGVmdCBpbnRhY3QuXG4gKiBDb3B5cmlnaHQgMjAwNywgMjAxNCBCcmlhbiBDaGVybmVcbiAqL1xuXG4vKiBob3ZlckludGVudCBpcyBzaW1pbGFyIHRvIGpRdWVyeSdzIGJ1aWx0LWluIFwiaG92ZXJcIiBtZXRob2QgZXhjZXB0IHRoYXRcbiAqIGluc3RlYWQgb2YgZmlyaW5nIHRoZSBoYW5kbGVySW4gZnVuY3Rpb24gaW1tZWRpYXRlbHksIGhvdmVySW50ZW50IGNoZWNrc1xuICogdG8gc2VlIGlmIHRoZSB1c2VyJ3MgbW91c2UgaGFzIHNsb3dlZCBkb3duIChiZW5lYXRoIHRoZSBzZW5zaXRpdml0eVxuICogdGhyZXNob2xkKSBiZWZvcmUgZmlyaW5nIHRoZSBldmVudC4gVGhlIGhhbmRsZXJPdXQgZnVuY3Rpb24gaXMgb25seVxuICogY2FsbGVkIGFmdGVyIGEgbWF0Y2hpbmcgaGFuZGxlckluLlxuICpcbiAqIC8vIGJhc2ljIHVzYWdlIC4uLiBqdXN0IGxpa2UgLmhvdmVyKClcbiAqIC5ob3ZlckludGVudCggaGFuZGxlckluLCBoYW5kbGVyT3V0IClcbiAqIC5ob3ZlckludGVudCggaGFuZGxlckluT3V0IClcbiAqXG4gKiAvLyBiYXNpYyB1c2FnZSAuLi4gd2l0aCBldmVudCBkZWxlZ2F0aW9uIVxuICogLmhvdmVySW50ZW50KCBoYW5kbGVySW4sIGhhbmRsZXJPdXQsIHNlbGVjdG9yIClcbiAqIC5ob3ZlckludGVudCggaGFuZGxlckluT3V0LCBzZWxlY3RvciApXG4gKlxuICogLy8gdXNpbmcgYSBiYXNpYyBjb25maWd1cmF0aW9uIG9iamVjdFxuICogLmhvdmVySW50ZW50KCBjb25maWcgKVxuICpcbiAqIEBwYXJhbSAgaGFuZGxlckluICAgZnVuY3Rpb24gT1IgY29uZmlndXJhdGlvbiBvYmplY3RcbiAqIEBwYXJhbSAgaGFuZGxlck91dCAgZnVuY3Rpb24gT1Igc2VsZWN0b3IgZm9yIGRlbGVnYXRpb24gT1IgdW5kZWZpbmVkXG4gKiBAcGFyYW0gIHNlbGVjdG9yICAgIHNlbGVjdG9yIE9SIHVuZGVmaW5lZFxuICogQGF1dGhvciBCcmlhbiBDaGVybmUgPGJyaWFuKGF0KWNoZXJuZShkb3QpbmV0PlxuICovXG5cbihmdW5jdGlvbiAoZmFjdG9yeSkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIGRlZmluZShbJ2pxdWVyeSddLCBmYWN0b3J5KTtcbiAgICB9IGVsc2UgaWYgKGpRdWVyeSAmJiAhalF1ZXJ5LmZuLmhvdmVySW50ZW50KSB7XG4gICAgICAgIGZhY3RvcnkoalF1ZXJ5KTtcbiAgICB9XG59KShmdW5jdGlvbiAoJCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIC8vIGRlZmF1bHQgY29uZmlndXJhdGlvbiB2YWx1ZXNcbiAgICB2YXIgX2NmZyA9IHtcbiAgICAgICAgaW50ZXJ2YWw6IDEwMCxcbiAgICAgICAgc2Vuc2l0aXZpdHk6IDYsXG4gICAgICAgIHRpbWVvdXQ6IDBcbiAgICB9O1xuXG4gICAgLy8gY291bnRlciB1c2VkIHRvIGdlbmVyYXRlIGFuIElEIGZvciBlYWNoIGluc3RhbmNlXG4gICAgdmFyIElOU1RBTkNFX0NPVU5UID0gMDtcblxuICAgIC8vIGN1cnJlbnQgWCBhbmQgWSBwb3NpdGlvbiBvZiBtb3VzZSwgdXBkYXRlZCBkdXJpbmcgbW91c2Vtb3ZlIHRyYWNraW5nIChzaGFyZWQgYWNyb3NzIGluc3RhbmNlcylcbiAgICB2YXIgY1gsIGNZO1xuXG4gICAgLy8gc2F2ZXMgdGhlIGN1cnJlbnQgcG9pbnRlciBwb3NpdGlvbiBjb29yZGluYXRlcyBiYXNlZCBvbiB0aGUgZ2l2ZW4gbW91c2Vtb3ZlIGV2ZW50XG4gICAgdmFyIHRyYWNrID0gZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgIGNYID0gZXYucGFnZVg7XG4gICAgICAgIGNZID0gZXYucGFnZVk7XG4gICAgfTtcblxuICAgIC8vIGNvbXBhcmVzIGN1cnJlbnQgYW5kIHByZXZpb3VzIG1vdXNlIHBvc2l0aW9uc1xuICAgIHZhciBjb21wYXJlID0gZnVuY3Rpb24gKGV2LCAkZWwsIHMsIGNmZykge1xuICAgICAgICAvLyBjb21wYXJlIG1vdXNlIHBvc2l0aW9ucyB0byBzZWUgaWYgcG9pbnRlciBoYXMgc2xvd2VkIGVub3VnaCB0byB0cmlnZ2VyIGBvdmVyYCBmdW5jdGlvblxuICAgICAgICBpZiAoTWF0aC5zcXJ0KChzLnBYIC0gY1gpICogKHMucFggLSBjWCkgKyAocy5wWSAtIGNZKSAqIChzLnBZIC0gY1kpKSA8IGNmZy5zZW5zaXRpdml0eSkge1xuICAgICAgICAgICAgJGVsLm9mZihzLmV2ZW50LCB0cmFjayk7XG4gICAgICAgICAgICBkZWxldGUgcy50aW1lb3V0SWQ7XG4gICAgICAgICAgICAvLyBzZXQgaG92ZXJJbnRlbnQgc3RhdGUgYXMgYWN0aXZlIGZvciB0aGlzIGVsZW1lbnQgKHBlcm1pdHMgYG91dGAgaGFuZGxlciB0byB0cmlnZ2VyKVxuICAgICAgICAgICAgcy5pc0FjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAvLyBvdmVyd3JpdGUgb2xkIG1vdXNlZW50ZXIgZXZlbnQgY29vcmRpbmF0ZXMgd2l0aCBtb3N0IHJlY2VudCBwb2ludGVyIHBvc2l0aW9uXG4gICAgICAgICAgICBldi5wYWdlWCA9IGNYO1xuICAgICAgICAgICAgZXYucGFnZVkgPSBjWTtcbiAgICAgICAgICAgIC8vIGNsZWFyIGNvb3JkaW5hdGUgZGF0YSBmcm9tIHN0YXRlIG9iamVjdFxuICAgICAgICAgICAgZGVsZXRlIHMucFg7XG4gICAgICAgICAgICBkZWxldGUgcy5wWTtcbiAgICAgICAgICAgIHJldHVybiBjZmcub3Zlci5hcHBseSgkZWxbMF0sIFtldl0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gc2V0IHByZXZpb3VzIGNvb3JkaW5hdGVzIGZvciBuZXh0IGNvbXBhcmlzb25cbiAgICAgICAgICAgIHMucFggPSBjWDtcbiAgICAgICAgICAgIHMucFkgPSBjWTtcbiAgICAgICAgICAgIC8vIHVzZSBzZWxmLWNhbGxpbmcgdGltZW91dCwgZ3VhcmFudGVlcyBpbnRlcnZhbHMgYXJlIHNwYWNlZCBvdXQgcHJvcGVybHkgKGF2b2lkcyBKYXZhU2NyaXB0IHRpbWVyIGJ1Z3MpXG4gICAgICAgICAgICBzLnRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbXBhcmUoZXYsICRlbCwgcywgY2ZnKTtcbiAgICAgICAgICAgIH0sIGNmZy5pbnRlcnZhbCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gdHJpZ2dlcnMgZ2l2ZW4gYG91dGAgZnVuY3Rpb24gYXQgY29uZmlndXJlZCBgdGltZW91dGAgYWZ0ZXIgYSBtb3VzZWxlYXZlIGFuZCBjbGVhcnMgc3RhdGVcbiAgICB2YXIgZGVsYXkgPSBmdW5jdGlvbiAoZXYsICRlbCwgcywgb3V0KSB7XG4gICAgICAgIGRlbGV0ZSAkZWwuZGF0YSgnaG92ZXJJbnRlbnQnKVtzLmlkXTtcbiAgICAgICAgcmV0dXJuIG91dC5hcHBseSgkZWxbMF0sIFtldl0pO1xuICAgIH07XG5cbiAgICAkLmZuLmhvdmVySW50ZW50ID0gZnVuY3Rpb24gKGhhbmRsZXJJbiwgaGFuZGxlck91dCwgc2VsZWN0b3IpIHtcbiAgICAgICAgLy8gaW5zdGFuY2UgSUQsIHVzZWQgYXMgYSBrZXkgdG8gc3RvcmUgYW5kIHJldHJpZXZlIHN0YXRlIGluZm9ybWF0aW9uIG9uIGFuIGVsZW1lbnRcbiAgICAgICAgdmFyIGluc3RhbmNlSWQgPSBJTlNUQU5DRV9DT1VOVCsrO1xuXG4gICAgICAgIC8vIGV4dGVuZCB0aGUgZGVmYXVsdCBjb25maWd1cmF0aW9uIGFuZCBwYXJzZSBwYXJhbWV0ZXJzXG4gICAgICAgIHZhciBjZmcgPSAkLmV4dGVuZCh7fSwgX2NmZyk7XG4gICAgICAgIGlmICgkLmlzUGxhaW5PYmplY3QoaGFuZGxlckluKSkge1xuICAgICAgICAgICAgY2ZnID0gJC5leHRlbmQoY2ZnLCBoYW5kbGVySW4pO1xuICAgICAgICAgICAgaWYgKCEkLmlzRnVuY3Rpb24oY2ZnLm91dCkpIHtcbiAgICAgICAgICAgICAgICBjZmcub3V0ID0gY2ZnLm92ZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoJC5pc0Z1bmN0aW9uKGhhbmRsZXJPdXQpKSB7XG4gICAgICAgICAgICBjZmcgPSAkLmV4dGVuZChjZmcsIHtvdmVyOiBoYW5kbGVySW4sIG91dDogaGFuZGxlck91dCwgc2VsZWN0b3I6IHNlbGVjdG9yfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjZmcgPSAkLmV4dGVuZChjZmcsIHtvdmVyOiBoYW5kbGVySW4sIG91dDogaGFuZGxlckluLCBzZWxlY3RvcjogaGFuZGxlck91dH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQSBwcml2YXRlIGZ1bmN0aW9uIGZvciBoYW5kbGluZyBtb3VzZSAnaG92ZXJpbmcnXG4gICAgICAgIHZhciBoYW5kbGVIb3ZlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAvLyBjbG9uZWQgZXZlbnQgdG8gcGFzcyB0byBoYW5kbGVycyAoY29weSByZXF1aXJlZCBmb3IgZXZlbnQgb2JqZWN0IHRvIGJlIHBhc3NlZCBpbiBJRSlcbiAgICAgICAgICAgIHZhciBldiA9ICQuZXh0ZW5kKHt9LCBlKTtcblxuICAgICAgICAgICAgLy8gdGhlIGN1cnJlbnQgdGFyZ2V0IG9mIHRoZSBtb3VzZSBldmVudCwgd3JhcHBlZCBpbiBhIGpRdWVyeSBvYmplY3RcbiAgICAgICAgICAgIHZhciAkZWwgPSAkKHRoaXMpO1xuXG4gICAgICAgICAgICAvLyByZWFkIGhvdmVySW50ZW50IGRhdGEgZnJvbSBlbGVtZW50IChvciBpbml0aWFsaXplIGlmIG5vdCBwcmVzZW50KVxuICAgICAgICAgICAgdmFyIGhvdmVySW50ZW50RGF0YSA9ICRlbC5kYXRhKCdob3ZlckludGVudCcpO1xuICAgICAgICAgICAgaWYgKCFob3ZlckludGVudERhdGEpIHtcbiAgICAgICAgICAgICAgICAkZWwuZGF0YSgnaG92ZXJJbnRlbnQnLCAoaG92ZXJJbnRlbnREYXRhID0ge30pKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gcmVhZCBwZXItaW5zdGFuY2Ugc3RhdGUgZnJvbSBlbGVtZW50IChvciBpbml0aWFsaXplIGlmIG5vdCBwcmVzZW50KVxuICAgICAgICAgICAgdmFyIHN0YXRlID0gaG92ZXJJbnRlbnREYXRhW2luc3RhbmNlSWRdO1xuICAgICAgICAgICAgaWYgKCFzdGF0ZSkge1xuICAgICAgICAgICAgICAgIGhvdmVySW50ZW50RGF0YVtpbnN0YW5jZUlkXSA9IHN0YXRlID0ge2lkOiBpbnN0YW5jZUlkfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gc3RhdGUgcHJvcGVydGllczpcbiAgICAgICAgICAgIC8vIGlkID0gaW5zdGFuY2UgSUQsIHVzZWQgdG8gY2xlYW4gdXAgZGF0YVxuICAgICAgICAgICAgLy8gdGltZW91dElkID0gdGltZW91dCBJRCwgcmV1c2VkIGZvciB0cmFja2luZyBtb3VzZSBwb3NpdGlvbiBhbmQgZGVsYXlpbmcgXCJvdXRcIiBoYW5kbGVyXG4gICAgICAgICAgICAvLyBpc0FjdGl2ZSA9IHBsdWdpbiBzdGF0ZSwgdHJ1ZSBhZnRlciBgb3ZlcmAgaXMgY2FsbGVkIGp1c3QgdW50aWwgYG91dGAgaXMgY2FsbGVkXG4gICAgICAgICAgICAvLyBwWCwgcFkgPSBwcmV2aW91c2x5LW1lYXN1cmVkIHBvaW50ZXIgY29vcmRpbmF0ZXMsIHVwZGF0ZWQgYXQgZWFjaCBwb2xsaW5nIGludGVydmFsXG4gICAgICAgICAgICAvLyBldmVudCA9IHN0cmluZyByZXByZXNlbnRpbmcgdGhlIG5hbWVzcGFjZWQgZXZlbnQgdXNlZCBmb3IgbW91c2UgdHJhY2tpbmdcblxuICAgICAgICAgICAgLy8gY2xlYXIgYW55IGV4aXN0aW5nIHRpbWVvdXRcbiAgICAgICAgICAgIGlmIChzdGF0ZS50aW1lb3V0SWQpIHtcbiAgICAgICAgICAgICAgICBzdGF0ZS50aW1lb3V0SWQgPSBjbGVhclRpbWVvdXQoc3RhdGUudGltZW91dElkKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gbmFtZXNwYWNlZCBldmVudCB1c2VkIHRvIHJlZ2lzdGVyIGFuZCB1bnJlZ2lzdGVyIG1vdXNlbW92ZSB0cmFja2luZ1xuICAgICAgICAgICAgdmFyIG1vdXNlbW92ZSA9IHN0YXRlLmV2ZW50ID0gJ21vdXNlbW92ZS5ob3ZlckludGVudC5ob3ZlckludGVudCcgKyBpbnN0YW5jZUlkO1xuXG4gICAgICAgICAgICAvLyBoYW5kbGUgdGhlIGV2ZW50LCBiYXNlZCBvbiBpdHMgdHlwZVxuICAgICAgICAgICAgaWYgKGUudHlwZSA9PT0gJ21vdXNlZW50ZXInKSB7XG4gICAgICAgICAgICAgICAgLy8gZG8gbm90aGluZyBpZiBhbHJlYWR5IGFjdGl2ZVxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5pc0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIHNldCBcInByZXZpb3VzXCIgWCBhbmQgWSBwb3NpdGlvbiBiYXNlZCBvbiBpbml0aWFsIGVudHJ5IHBvaW50XG4gICAgICAgICAgICAgICAgc3RhdGUucFggPSBldi5wYWdlWDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5wWSA9IGV2LnBhZ2VZO1xuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBcImN1cnJlbnRcIiBYIGFuZCBZIHBvc2l0aW9uIGJhc2VkIG9uIG1vdXNlbW92ZVxuICAgICAgICAgICAgICAgICRlbC5vZmYobW91c2Vtb3ZlLCB0cmFjaykub24obW91c2Vtb3ZlLCB0cmFjayk7XG4gICAgICAgICAgICAgICAgLy8gc3RhcnQgcG9sbGluZyBpbnRlcnZhbCAoc2VsZi1jYWxsaW5nIHRpbWVvdXQpIHRvIGNvbXBhcmUgbW91c2UgY29vcmRpbmF0ZXMgb3ZlciB0aW1lXG4gICAgICAgICAgICAgICAgc3RhdGUudGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBhcmUoZXYsICRlbCwgc3RhdGUsIGNmZyk7XG4gICAgICAgICAgICAgICAgfSwgY2ZnLmludGVydmFsKTtcbiAgICAgICAgICAgIH0gZWxzZSB7IC8vIFwibW91c2VsZWF2ZVwiXG4gICAgICAgICAgICAgICAgLy8gZG8gbm90aGluZyBpZiBub3QgYWxyZWFkeSBhY3RpdmVcbiAgICAgICAgICAgICAgICBpZiAoIXN0YXRlLmlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gdW5iaW5kIGV4cGVuc2l2ZSBtb3VzZW1vdmUgZXZlbnRcbiAgICAgICAgICAgICAgICAkZWwub2ZmKG1vdXNlbW92ZSwgdHJhY2spO1xuICAgICAgICAgICAgICAgIC8vIGlmIGhvdmVySW50ZW50IHN0YXRlIGlzIHRydWUsIHRoZW4gY2FsbCB0aGUgbW91c2VPdXQgZnVuY3Rpb24gYWZ0ZXIgdGhlIHNwZWNpZmllZCBkZWxheVxuICAgICAgICAgICAgICAgIHN0YXRlLnRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBkZWxheShldiwgJGVsLCBzdGF0ZSwgY2ZnLm91dCk7XG4gICAgICAgICAgICAgICAgfSwgY2ZnLnRpbWVvdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIGxpc3RlbiBmb3IgbW91c2VlbnRlciBhbmQgbW91c2VsZWF2ZVxuICAgICAgICByZXR1cm4gdGhpcy5vbih7J21vdXNlZW50ZXIuaG92ZXJJbnRlbnQnOiBoYW5kbGVIb3ZlciwgJ21vdXNlbGVhdmUuaG92ZXJJbnRlbnQnOiBoYW5kbGVIb3Zlcn0sIGNmZy5zZWxlY3Rvcik7XG4gICAgfTtcbn0pOyIsIi8qKlxuICogTmV0d29yayBOYXYgRnVuY3Rpb25hbGl0eVxuICpcbiAqIHRvZG86IGNvbmRlbnNlIGFqYXggZnVuY3Rpb25zIGludG8gb25lIGNhbGxcbiAqIHRvZG86IHJlZmFjdG9yIGNvbnRlbnQgbG9hZGluZ1xuICogdG9kbzogcmVmYWN0b3IgdGhpcyBmaWxlIGludG8gYW4gc2luZ2xlIG9iamVjdFxuICovXG5cbmpRdWVyeSggZG9jdW1lbnQgKS5yZWFkeSggZnVuY3Rpb24oICQgKSB7XG5cblx0JCggJy5mcy1uZXR3b3JrLXV0aWwtdG9nZ2xlJyApLmNsaWNrKCBmdW5jdGlvbigpIHtcblx0XHQkKCAnYm9keScgKS50b2dnbGVDbGFzcyggJ2ZzLXV0aWwtbmF2LW9wZW4nICk7XG5cdFx0JCggJy5mcy1uZXR3b3JrLXV0aWwnICkudG9nZ2xlQ2xhc3MoICdpcy1vcGVuJyApO1xuXHRcdCQoICcuZnMtbmV0d29yay11dGlsLXRvZ2dsZScgKS50b2dnbGVDbGFzcyggJ29wZW4nICk7XG5cdH0pO1xuXG5cdCQoICcuZnMtbmV0d29yay1zb2NpYWwtdG9nZ2xlJyApLmNsaWNrKCBmdW5jdGlvbigpIHtcblx0XHQkKCAnLmZzLW5ldHdvcmstc29jaWFsJyApLnRvZ2dsZUNsYXNzKCAnaXMtb3BlbicgKTtcblx0XHQkKCAnLmZzLW5ldHdvcmstc29jaWFsLXRvZ2dsZScgKS50b2dnbGVDbGFzcyggJ29wZW4nICk7XG5cdH0gKTtcblxuXHQkKCAnLmZzLW5ldHdvcmstc2VhcmNoLXRvZ2dsZScgKS5jbGljayggZnVuY3Rpb24oKSB7XG5cdFx0JCggJyNmcy1uZXR3b3JrLXNlYXJjaCcgKS50b2dnbGVDbGFzcyggJ29wZW4nICk7XG5cdFx0JCggJyNmcy1uZXR3b3JrLW1lbnUnICkudG9nZ2xlQ2xhc3MoICdzZWFyY2gtdmlzaWJsZScgKTtcblx0fSApO1xuXG4gICAgLy8gcmVtb3ZlIGZ1bmN0aW9uYWxpdHkgZm9yIG9sZGVyIGFuZHJvaWQgYnJvd3NlcnNcbiAgICBmdW5jdGlvbiBnZXRBbmRyb2lkVmVyc2lvbih1YSkge1xuICAgICAgICB1YSA9ICh1YSB8fCBuYXZpZ2F0b3IudXNlckFnZW50KS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB2YXIgbWF0Y2ggPSB1YS5tYXRjaCgvYW5kcm9pZFxccyhbMC05XFwuXSopLyk7XG4gICAgICAgIHJldHVybiBtYXRjaCA/IG1hdGNoWzFdIDogZmFsc2U7XG4gICAgfTtcblxuICAgIHZhciBhbmRyb2lkVmVyc2lvbiA9IGdldEFuZHJvaWRWZXJzaW9uKCk7XG4gICAgYW5kcm9pZFZlcnNpb24gPSBwYXJzZUludChhbmRyb2lkVmVyc2lvbiwgMTApOyAvLzRcblxuICAgIGlmIChhbmRyb2lkVmVyc2lvbiA8IDUuMCkge1xuICAgICAgICAkKCcuZnMtbmV0d29yay1zZWFyY2gtdG9nZ2xlJykucmVtb3ZlKCk7XG4gICAgICAgICQoJy5mcy1uZXR3b3JrLXV0aWwtdG9nZ2xlJykucmVtb3ZlKCk7XG4gICAgICAgICQoJy5mcy1uZXR3b3JrLXV0aWwnKS5yZW1vdmUoKTtcbiAgICB9XG5cbiAgICBjaGVja01lbnVEaXNwbGF5U2l6ZSgpO1xuICAgICQod2luZG93KS5yZXNpemUoIGNoZWNrTWVudURpc3BsYXlTaXplICk7XG5cbiAgICBnZXRNb2JpbGVDb250ZW50KCk7XG5cblx0ZnVuY3Rpb24gY2hlY2tNZW51RGlzcGxheVNpemUoKSB7XG5cblx0XHR2YXIgZGVza3RvcE5hdldpZHRoID0gJCgnLmZzLW5ldHdvcmstbWVudS5kZXNrdG9wJykud2lkdGgoKSxcblx0XHRcdGVsZW1lbnRzID0gJCgnLmZzLW5ldHdvcmstbWVudS5kZXNrdG9wID4gbGknKSxcblx0XHRcdHRyYWNrZXIgPSAwO1xuXG5cdFx0LyoqXG5cdFx0ICogR2V0IHRoZSB0b3RhbCB3aWR0aCBvZiBjb21iaW5lZCBsaSB3aWR0aHMuIFdoaWxlIHNtYWxsZXIsIHJlbW92ZSB0aGUgaGlkZGVuIGNsYXNzIHRvIHRvZ2dsZSB2aXNpYmlsaXR5LlxuXHRcdCAqL1xuXHRcdCQuZWFjaCggZWxlbWVudHMsIGZ1bmN0aW9uIChpbmRleCwgdmFsICkge1xuXG5cdFx0XHR2YXIgZWwgPSAkKHZhbCk7XG5cdFx0XHR0cmFja2VyICs9IGVsLndpZHRoKCk7XG5cblx0XHRcdGlmICh0cmFja2VyIDw9IGRlc2t0b3BOYXZXaWR0aCApIHtcblx0XHRcdFx0ZWwucmVtb3ZlQ2xhc3MoJ25ldHdvcmstaXRlbS1oaWRlJykuYWRkQ2xhc3MoJ25ldHdvcmstaXRlbS1zaG93Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRlbC5yZW1vdmVDbGFzcygnbmV0d29yay1pdGVtLXNob3cnKS5hZGRDbGFzcygnbmV0d29yay1pdGVtLWhpZGUnKTtcblx0XHRcdH1cblxuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gdG9nZ2xlU3RhdGUoIGVsICkge1xuXHRcdGVsLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ29wZW4nKTsgLy8gZW5zdXJlIGFsbCBvdGhlciB0b3AgbGV2ZWwgaXRlbXMgYXJlIGNsb3NlZFxuXHRcdGVsLmFkZENsYXNzKCdvcGVuJyk7XG5cblx0XHRnZXREcm9wZG93bkNvbnRlbnQoZWwpO1xuXHR9XG5cblx0Ly8gVG91Y2ggRGV2aWNlIERldGVjdGlvblxuXHQvLyBUT0RPOiB0aGlzIGN1cnJlbnRseSBkZXBlbmRzIG9uIHRoZXJlIGJlaW5nIGEgYHRvdWNoYCBib2R5IGNsYXNzIGFkZGVkIGJ5IHRoZSB0aGVtZS9tb2Rlcm5pemVyXG5cdGlmICggJCggJ2h0bWwnICkuaGFzQ2xhc3MoICd0b3VjaCcgKSApIHtcblxuXHRcdCQoICcuZnMtbmV0d29yay1tZW51IGxpLmRyb3Bkb3duID4gYScgKS5vbiggJ2NsaWNrJywgZnVuY3Rpb24oIGUgKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR2YXIgbXlMSSA9ICQoIHRoaXMgKS5wYXJlbnQoKTtcblx0XHRcdHRvZ2dsZVN0YXRlKG15TEkpO1xuXHRcdH0gKTtcblxuXHR9IGVsc2Uge1xuXG5cdFx0dmFyIG1lbnVJdGVtTGluayA9ICQoJy5mcy1uZXR3b3JrLW1lbnUgbGkuZHJvcGRvd24gPiBhJyksXG5cdFx0XHRsb2FkZXIgPSAkKCcubG9hZGVyJyk7XG5cblx0XHRtZW51SXRlbUxpbmsub24oICdjbGljaycsIGZ1bmN0aW9uKCBlICkge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdH0pO1xuXG5cdFx0dmFyIG9wZW5Ecm9wZG93biA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHZhciBteUxJID0gJCh0aGlzKTtcblx0XHRcdHRvZ2dsZVN0YXRlKG15TEkpO1xuXHRcdH07XG5cblx0XHR2YXIgY2xvc2VEcm9wZG93biA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdCQoJy5mcy1uZXR3b3JrLW1lbnUgbGkuZHJvcGRvd24nKS5yZW1vdmVDbGFzcyggJ29wZW4nICk7XG5cblx0XHRcdC8vIFJlbW92ZSB0aGUgbG9hZGVyIGVsZW1lbnQgaWYgdGhlIHVzZXIgbW91c2VzIG9mZiBiZWZvcmUgbG9hZGluZ1xuXHRcdFx0aWYgKCBsb2FkZXIubGVuZ3RoID4gMCApIHtcblx0XHRcdFx0bG9hZGVyLnJlbW92ZSgpO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHQkKCcuZnMtbmV0d29yay1tZW51JykuaG92ZXJJbnRlbnQoe1xuXHRcdFx0b3Zlcjogb3BlbkRyb3Bkb3duLFxuXHRcdFx0b3V0OiBjbG9zZURyb3Bkb3duLFxuICAgICAgICAgICAgdGltZW91dDogMjAwLFxuXHRcdFx0c2VsZWN0b3I6ICdsaS5kcm9wZG93bidcblx0XHR9KTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gZ2V0RHJvcGRvd25Db250ZW50KCBteUxJICkge1xuXG5cdFx0Ly8gZm9yIGEgZHJvcGRvd24gd2l0aCBmZWVkcywgd2UgZG9uJ3QgbmVlZCB0byBwcm9jZWVkIGlmIGFscmVhZHkgbG9hZGVkIHRoZSBBSkFYIGNvbnRlbnRcblx0XHRpZiAoICQobXlMSSkuaGFzQ2xhc3MoJ2xvYWRpbmcnKSB8fCAkKG15TEkpLmhhc0NsYXNzKCdsb2FkZWQnKSApIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRpZiAoICQoIG15TEkgKS5oYXNDbGFzcyggJ2ZlZWQtZHJvcGRvd24nICkgKSB7XG5cblx0XHRcdC8vIHNldCB1cCBhbiBhcnJheSB3aXRoIGFsbCBvZiB0aGUgY29sdW1ucyBmZWVkcyB3ZSdsbCBuZWVkIHRvIGdyYWIgY29udGVudCBmb3Jcblx0XHRcdHZhciBkYXRhRmVlZHMgPSBbXTtcblx0XHRcdCQoICcucHJpbWFyeSAuY29sdW1uJywgbXlMSSApLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQvLyBncmFiIGJvdGggdGhlIGZlZWQgQVBJIGNhbGwgYW5kIHRoZSBsYXlvdXQgd2UnbGwgbmVlZCB0byBmb3JtYXQgdGhlIG1hcmt1cCBmb3Jcblx0XHRcdFx0dmFyIGFyZ3MgPSAkKHRoaXMpLmRhdGEoJ2ZlZWQnKTtcblx0XHRcdFx0dmFyIGFkZEZlZWQgPSB7XG5cdFx0XHRcdFx0J2ZlZWQnOiBhcmdzLFxuXHRcdFx0XHRcdCdsYXlvdXQnOiAkKCB0aGlzICkuZGF0YSggJ2xheW91dCcgKVxuXHRcdFx0XHR9O1xuXHRcdFx0XHRkYXRhRmVlZHMucHVzaCggYWRkRmVlZCApO1xuXHRcdFx0fSApO1xuXG5cdFx0XHR2YXIgZHJvcGRvd25Db250ZW50ID0gZ2V0Q29sdW1uQ29udGVudCggZGF0YUZlZWRzLCBteUxJICk7XG5cblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdH1cblxuICAgIGZ1bmN0aW9uIGdldENvbHVtbkNvbnRlbnQoIGRhdGFGZWVkcywgbXlMSSApIHtcblx0XHQvLyBjb252ZXJ0IG9iamVjdCB0byBKU09OIGFuZCBlbmNvZGUgZm9yIFVSTCBwYXNzdGhyb3VnaCBhIGxhIFNJXG5cdFx0dmFyIGZlZWRzID0gZW5jb2RlVVJJQ29tcG9uZW50KCBKU09OLnN0cmluZ2lmeSggZGF0YUZlZWRzICkgKTtcblx0XHR2YXIgdXJsID0gc2l0ZURhdGEucmVzdHVybCArICdtZW51cy9uZXR3b3JrLW5hdi9kcm9wZG93bi8/Y29sdW1ucz0nICsgZmVlZHM7XG5cblx0XHQkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICB0eXBlOiBcIkdFVFwiLFxuICAgICAgICAgICAgYmVmb3JlU2VuZDogZnVuY3Rpb24gKCB4aHIgKSB7XG5cdFx0XHRcdHhoci5zZXRSZXF1ZXN0SGVhZGVyKCAneC1mc2FwaS1ub25jZScsIHNpdGVEYXRhLm5vbmNlICk7XG4gICAgICAgICAgICAgICAgJChteUxJKS5hZGRDbGFzcygnbG9hZGluZycpO1xuICAgICAgICAgICAgICAgICQoJy5wcmltYXJ5IC5jb2x1bW4nKS5hcHBlbmQoJzxzcGFuIGNsYXNzPVwibG9hZGVyXCIgLz4nKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcblxuICAgICAgICAgICAgICAgICQoJy5sb2FkZXInKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgIC8vIHByZXBlbmQgZWFjaCBjb2x1bW4gd2l0aCBpdHMgY29ycmVzcG9uZGluZyBkYXRhIGZyb20gdGhlIEFKQVggcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAkKCcucHJpbWFyeSAuY29sdW1uJywgbXlMSSkuZWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5wcmVwZW5kKHJlc3BvbnNlW2luZGV4XSk7XG4gICAgICAgICAgICAgICAgICAgICQobXlMSSkuYWRkQ2xhc3MoJ2xvYWRlZCcpO1xuICAgICAgICAgICAgICAgICAgICAkKG15TEkpLnJlbW92ZUNsYXNzKCdsb2FkaW5nJyk7XG4gICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgIC8vIEluIHRoZSB0cmVuZGluZyBjb2x1bW4sIHRoZSBzY3JvbGxhYmxlIGNvbnRhaW5lciBuZWVkcyBhIHNldCB3aWR0aCxcbiAgICAgICAgICAgICAgICAvLyB0aGUgbWF0aCBiZWxvdyBkeW5hbWljYWxseSBnZW5lcmF0ZXMgdGhlIHdpZHRoLlxuICAgICAgICAgICAgICAgIHZhciB0cmVuZGluZyA9ICQoJy50cmVuZGluZyAuY29sdW1uJyk7XG4gICAgICAgICAgICAgICAgaWYgKHRyZW5kaW5nLmxlbmd0aCA+IDApIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbGlzdCA9IHRyZW5kaW5nLmZpbmQoJ3VsJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0Tm9kZSA9IGxpc3QuZmluZCgnbGknKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3ROb2RlV2lkdGggPSBsaXN0Tm9kZS53aWR0aCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdE5vZGVDb3VudCA9IGxpc3ROb2RlLmxlbmd0aCxcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWRkcmVzc2VkIG9ycGhhbmVkIGVsZW1lbnRzIGluIG1haW4gbmF2XG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0QnVmZmVyID0gMTAsXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHR1cm4gXCIzMHB4XCIgaW50byBpbnQgMzBcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RNYXJnaW4gPSBwYXJzZUludChsaXN0Tm9kZS5jc3MoJ21hcmdpbi1yaWdodCcpLnJlcGxhY2UoJ3B4JywgJycpKSArIGxpc3RCdWZmZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0V2lkdGggPSAoICggbGlzdE5vZGVXaWR0aCArIGxpc3RNYXJnaW4gKSAqIGxpc3ROb2RlQ291bnQgKSAtIGxpc3RNYXJnaW47XG5cbiAgICAgICAgICAgICAgICAgICAgbGlzdC53aWR0aChsaXN0V2lkdGgpO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGlmICh0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgKCBkZWJ1ZyA9PSAndHJ1ZScgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuXHRmdW5jdGlvbiBnZXRRdWVyeVZhcmlhYmxlKCB2YXJpYWJsZSApIHtcblx0XHR2YXIgcXVlcnkgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnN1YnN0cmluZyggMSApO1xuXHRcdHZhciB2YXJzID0gcXVlcnkuc3BsaXQoIFwiJlwiICk7XG5cdFx0Zm9yICggdmFyIGkgPSAwOyBpIDwgdmFycy5sZW5ndGg7IGkrKyApIHtcblx0XHRcdHZhciBwYWlyID0gdmFyc1tpXS5zcGxpdCggXCI9XCIgKTtcblx0XHRcdGlmICggcGFpclswXSA9PSB2YXJpYWJsZSApIHtcblx0XHRcdFx0cmV0dXJuIHBhaXJbMV07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiAoZmFsc2UpO1xuXHR9XG5cbiAgICBmdW5jdGlvbiBnZXRNb2JpbGVDb250ZW50KCkge1xuXG4gICAgICAgIHZhciBib2R5ID0gJCgnYm9keScpO1xuXG4gICAgICAgIGlmICggYm9keS53aWR0aCgpIDwgNjAwICkge1xuXG4gICAgICAgICAgICBib2R5Lm9uKCdjbGljaycsICcuZnMtdXRpbGl0eS1saW5rJywgZnVuY3Rpb24oZSl7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGluayA9ICQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgIGxpID0gbGluay5wYXJlbnQoKSxcbiAgICAgICAgICAgICAgICAgICAgZmVlZCA9IGxpLmRhdGEoJ2ZlZWQnKSB8fCAnJyxcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXAgPSBsaS5kYXRhKCdncm91cCcpIHx8ICcnLFxuXHRcdFx0XHRcdGxpbmtzID0gbGkuZGF0YSgnbGlua3MnKSB8fCAnJztcblxuICAgICAgICAgICAgICAgIC8vIGVuYWJsZSBsaW5rcyBpZiBubyBkcm9wZG93biBjb250ZW50XG4gICAgICAgICAgICAgICAgaWYgKCdsaW5rJyA9PT0gbGkuZGF0YShcInR5cGVcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgIC8vIGlmIHdlIGhhdmUgbG9hZGVkIHRoZSBkYXRhXG4gICAgICAgICAgICAgICAgaWYgKCAoIGZhbHNlID09PSBsaS5kYXRhKFwibG9hZGVkXCIpIHx8IHVuZGVmaW5lZCA9PSBsaS5kYXRhKFwibG9hZGVkXCIpKSAmJiAhIGxpLmhhc0NsYXNzKCdsb2FkaW5nJykgKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpLmFkZENsYXNzKCdsb2FkaW5nJyk7XG4gICAgICAgICAgICAgICAgICAgIGxpLmZpbmQoJy5mcy11dGlsaXR5LWFwaS1uYXYtdG9nZ2xlJykuYWRkQ2xhc3MoJ29wZW4nKTtcblxuICAgICAgICAgICAgICAgICAgICBsb2FkZWRNb2JpbGVDb250ZW50KCBsaSwgZmVlZCwgZ3JvdXAsIGxpbmtzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIHRydWUgPT09IGxpLmRhdGEoXCJsb2FkZWRcIikgKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpLmZpbmQoJy5mcy11dGlsaXR5LW5hdi1jb250ZW50Jykuc3RvcCgpLnNsaWRlVG9nZ2xlKDUwMCk7XG4gICAgICAgICAgICAgICAgICAgIGxpLmZpbmQoJy5mcy11dGlsaXR5LWFwaS1uYXYtdG9nZ2xlJykudG9nZ2xlQ2xhc3MoJ29wZW4nKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvYWRlZE1vYmlsZUNvbnRlbnQoIGVsLCBmZWVkLCBncm91cCwgbGlua3MgKSB7XG5cdFx0dmFyIGZpbmFsTGlua3MgPSBlbmNvZGVVUklDb21wb25lbnQoIEpTT04uc3RyaW5naWZ5KGxpbmtzKSk7XG5cdFx0dmFyIGZpbmFsRmVlZCA9IGVuY29kZVVSSUNvbXBvbmVudCggSlNPTi5zdHJpbmdpZnkoIGZlZWQgKSApO1xuXHRcdHZhciBmaW5hbEdyb3VwID0gZW5jb2RlVVJJQ29tcG9uZW50KCBKU09OLnN0cmluZ2lmeSggZ3JvdXAgKSApO1xuXHRcdHZhciB1cmwgPSBzaXRlRGF0YS5yZXN0dXJsICsgJ21lbnVzL25ldHdvcmstbmF2L21vYmlsZS8/c3ViY29udGVudD0nICsgZmluYWxGZWVkICsgJyZncm91cD0nICsgZmluYWxHcm91cCArXG5cdFx0JyZsaW5rcz0nICsgZmluYWxMaW5rcztcbiAgICAgICAgJC5hamF4KHtcblx0XHRcdHVybDogdXJsLFxuICAgICAgICAgICAgdHlwZTogXCJHRVRcIixcbiAgICAgICAgICAgIGJlZm9yZVNlbmQ6IGZ1bmN0aW9uICggeGhyICkge1xuXHRcdFx0XHR4aHIuc2V0UmVxdWVzdEhlYWRlciggJ3gtZnNhcGktbm9uY2UnLCBzaXRlRGF0YS5ub25jZSApO1xuXHRcdFx0XHRlbC5hcHBlbmQoJzxzcGFuIGNsYXNzPVwibG9hZGVyXCIgLz4nKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coIHJlc3BvbnNlICk7XG4gICAgICAgICAgICAgICAgJCgnLmxvYWRlcicpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIGVsLnJlbW92ZUNsYXNzKCdsb2FkaW5nJyk7XG5cbiAgICAgICAgICAgICAgICBlbC5hcHBlbmQoIHJlc3BvbnNlICk7XG4gICAgICAgICAgICAgICAgZWwuZGF0YShcImxvYWRlZFwiLCB0cnVlKTtcbiAgICAgICAgICAgICAgICBlbC5hdHRyKFwiZGF0YS1sb2FkZWRcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgZWwuZGF0YShcInRvZ2dsZVwiLCBcIm9wZW5cIik7XG4gICAgICAgICAgICAgICAgZWwuYXR0cihcImRhdGEtdG9nZ2xlXCIsIFwib3BlblwiKTtcblxuICAgICAgICAgICAgICAgICQoIGVsICkuZmluZCgnLmZzLXV0aWxpdHktbmF2LWNvbnRlbnQnKS5mYWRlSW4oJ2Zhc3QnKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcblxuICAgICAgICAgICAgICAgIGVsLmFwcGVuZCgnPHA+Tm8gZGF0YSBjb3VsZCBiZSBsb2FkZWQ8L3A+Jyk7XG4gICAgICAgICAgICAgICAgLy8gaWYgKHRydWUpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgLy9pZiAoIGRlYnVnID09ICd0cnVlJyApIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICB9XG5cblxuXG59ICk7XG5cbi8qKlxuICogTmV0d29yayBOYXYgRmxpcGNhcmQgKGJhc2VkIG9uIEZTdjQgZmxpcGNhcmQgbG9naWMpXG4gKi9cbmpRdWVyeSggd2luZG93ICkuc2Nyb2xsKCBmdW5jdGlvbigpIHtcblx0aWYgKCBqUXVlcnkoIHdpbmRvdyApLnNjcm9sbFRvcCgpID4gMTQ3ICkge1xuXHRcdGpRdWVyeSggJyNmcy1uZXR3b3JrLW5hdicgKS5hZGRDbGFzcyggJ3Njcm9sbGVkJyApO1xuXHRcdGpRdWVyeSggJ2JvZHknICkuYWRkQ2xhc3MoICdmcy1uZXR3b3JrLW5hdi1zY3JvbGxlZCcgKTtcblx0fSBlbHNlIHtcblx0XHRqUXVlcnkoICcjZnMtbmV0d29yay1uYXYnICkucmVtb3ZlQ2xhc3MoICdzY3JvbGxlZCcgKTtcblx0XHRqUXVlcnkoICdib2R5JyApLnJlbW92ZUNsYXNzKCAnZnMtbmV0d29yay1uYXYtc2Nyb2xsZWQnICk7XG5cdH1cblxuXHRpZiAoIGpRdWVyeSggd2luZG93ICkud2lkdGgoKSA+IDc2NyAmJiBqUXVlcnkoICdib2R5JyApLmhhc0NsYXNzKCAnc2luZ2xlLXBvc3QnICkgKSB7XG5cdFx0aWYgKCBqUXVlcnkoIHdpbmRvdyApLnNjcm9sbFRvcCgpID4gMTQ3ICkge1xuXHRcdFx0alF1ZXJ5KCAnI2ZzLW5ldHdvcmstbmF2JyApLmFkZENsYXNzKCAnZmxpcGNhcmQnICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGpRdWVyeSggJyNmcy1uZXR3b3JrLW5hdicgKS5yZW1vdmVDbGFzcyggJ2ZsaXBjYXJkJyApO1xuXHRcdH1cblx0fVxufSApOyJdfQ==
